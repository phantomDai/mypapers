
# 蜕变关系识别、选择方法总结

该文档主要列举与蜕变关系识别与选择有关的工作。

## 蜕变关系选择策略

1. 尽可能多地使用蜕变关系。 [T. Y. Chen, 2004, "Metamorphic testing and testing with special values"]
2. 选择让原始测试用例与衍生测试用例的执行尽可能不同的蜕变关系。 [T. Y. Chen, 2004, "Case Studies on the Selection of Useful Relations in Metamorphic Testing"]
3. “好”的蜕变关系容易受程序语义的影响。 [J. Mayer, 2006, "An empirical study on the selection of good metamorphic relations"]
4. 选择与代码实现无关的蜕变关系。[T. Y. Chen, 2004, "Case Studies on the Selection of Useful Relations in Metamorphic Testing"; J. Mayer, 2006, "An empirical study on the selection of good metamorphic relations"]
5. 原始测试用例与衍生测试用例覆盖的代码越多、执行差异越大，蜕变关系越有效。[M. Asrafi, 2011, "On testing effectiveness of metamorphic relations: A case study"]
6. MT仅需要3-6个蜕变关系就能识别至少90%的故障。[Huai Liu, 2013, "How Effectively does Metamorphic Testing Alleviate the Oracle Problem?"]
7. 与系统级的蜕变关系相比，针对程序特定部分的蜕变关系的故障检测效率更高。[XiaoYuan Xie, 2014, "Bottom-up integration testing with the technique of metamorphic testing"]
8. 在两两之间距离为0的蜕变关系集中，只需要选择其中一个蜕变关系进行测试。[T. Y. Chen, 2017, "Metamorphic Testing: A Review of Challenges and Opportunities"]

## 候选的蜕变关系选择策略

由于本文研究对象的限制，部分策略不适用，具体来说：（1）文章中涉及到的蜕变关系均与代码实现无关，因此“选择与代码实现无关的蜕变关系”策略可以忽略；（2）实验室程序的规模较小，识别的所有蜕变关系均是系统级别的。为grep和FastJson识别的蜕变关系均依据程序特定部分的属性得到的。综合这两方面的考虑，“与系统级的蜕变关系相比，针对程序特定部分的蜕变关系的故障检测效率更高”策略可以忽略；（3）随着对MT研究的不断深入，MT相关理论得到不断发展。第六条策略是第一条策略的完善与补充，因此我们将第六条策略作为我们的候选策略，忽略第一条策略；（4）我们的研究是基于黑盒的研究，不涉及程序的结构，因此“原始测试用例与衍生测试用例覆盖的代码越多、执行差异越大，蜕变关系越有效”策略不适用。

基于上面的分析，我们得到最终的候选蜕变关系选择策略：

1. **选择让原始测试用例与衍生测试用例的执行尽可能不同的蜕变关系。** [T. Y. Chen, 2004, "Case Studies on the Selection of Useful Relations in Metamorphic Testing"]

2. **“好”的蜕变关系容易受程序语义的影响。** [J. Mayer, 2006, "An Empirical Study on the Selection of Good Metamorphic Relations"]

3. **MT仅需要3-6个蜕变关系就能识别至少90%的故障。**[Huai Liu, 2013, "How Effectively does Metamorphic Testing Alleviate the Oracle Problem?"]

4. **在两两之间距离为0的蜕变关系集中，只需要选择其中一个蜕变关系进行测试。**[T. Y. Chen, 2017, "Metamorphic Testing: A Review of Challenges and Opportunities"]

## 蜕变关系选择规则（算法）

规则2表明“好”的蜕变关系应该包含问题的领域知识（黑盒）。将规则1与2一起考虑，即从黑盒的角度对待“执行尽可能不同”。既然我们的测试用例是基于CPM方法得到的，我们可以通过衡量原始测试用例与衍生测试用例的选项差异来反映“执行尽可能不同”。由此，我们选择蜕变关系的步骤如下：
1. 根据原始测试用例与衍生测试用例的不同将所有的蜕变关系进行排序（不同程度最大的处于第一个位置）；
2. 从原始测试用例与衍生测试用例的距离相同的蜕变关系中随机选取一个，其它的蜕变关系从列表中删除；
3. 如果剩余的蜕变关系数目大于6，就按照制定而下的方式选取6个蜕变关系；否则，将列表中的所有蜕变关系作为待测试的蜕变关系。


   
   

















